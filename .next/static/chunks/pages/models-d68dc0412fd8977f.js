(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[495],{1313:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/models",function(){return r(6692)}])},1163:function(e,t,r){e.exports=r(3079)},6692:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var i=r(5893),l=r(7294),s=r(6725);let n={Tf:35,R:8500,A:42,F:6.8,Ef:2200,Ev:12,Wf:4500,c:78,s:3200,h:15.5,K:8.2,Efs:1800,Evs:9.5,O:2500,S:6.8,Ws:3200,a:15e3,b:120,gamma:850,delta:1200,C:180},a={parameters:{gf:2800,tf:35,gs:2200,t:25,price:88,crm:1500},savedModels:[{id:1,name:"基準模型",gf:2800,tf:35,gs:2200,t:25,price:88,crm:1500,totalCost:182450,createdAt:"2024-01-15"},{id:2,name:"成本優化模型",gf:3200,tf:32,gs:2600,t:22,price:90,crm:1200,totalCost:175800,createdAt:"2024-01-14"},{id:3,name:"高效減排模型",gf:4500,tf:28,gs:3800,t:20,price:95,crm:1800,totalCost:189200,createdAt:"2024-01-13"},{id:4,name:"平衡策略模型",gf:3500,tf:30,gs:2800,t:24,price:92,crm:1400,totalCost:178900,createdAt:"2024-01-12"}]};function o(){var e,t,r,o;let[v,w]=(0,l.useState)(!0),[N,z]=(0,l.useState)(0),[B,R]=(0,l.useState)({gf:2800,tf:35,gs:2200,t:25,price:88,crm:1500}),[W,M]=(0,l.useState)([]),[$,F]=(0,l.useState)(!1),[A,D]=(0,l.useState)(!1),[I,L]=(0,l.useState)(null),[P,T]=(0,l.useState)("gf"),[E,O]=(0,l.useState)(null);(0,l.useEffect)(()=>{q()},[]);let V=e=>Math.log(1+e)/(1+Math.log(1+e)),_=(e,t)=>{let{a:r,b:i}=n;return Math.max(1e3,r-i*(1+t/1e4)*e)},H=(e,t,r,i)=>{let l=_(r,i),{R:s,A:a,F:o,Ef:d,Ev:c,Wf:m,C:h}=n,x=V(e),f=e/t,g=s*h/t*(1-x),u=l*a*h*(1-x),p=l*l*t*o*h/2*(1-x),b=d*h/t*(1-x),y=l*c*h*(1-x),j=m*h*(1-x);return{total:f+g+u+p+b+y+j,breakdown:{investment:f,startupCarbon:g,productionCarbon:u,storageCarbon:p,transportFixedCarbon:b,transportVariableCarbon:y,additionalPenalty:j}}},X=(e,t,r,i)=>{let l=_(r,i),{c:s,s:a,h:o,K:d,Efs:c,Evs:m,O:h,S:x,Ws:f,gamma:g,delta:u,C:p}=n,b=V(e),y=l*s/t,j=a/t,v=l*l*(o+d*p*(1-b))/(2*t),C=(c*p*(1-b)+l*m*p*(1-b))/t,S=h*p*(1-b)/t,k=l*x*p*(1-b)/t,w=e/t,N=f*p*(1-b),z=g*r*r/(2*t),B=u*i*i/(2*t);return{total:y+i+j+v+C+S+k+w+N+z+B,breakdown:{procurement:y,crm:i,ordering:j,holdingCarbon:v,transportCarbon:C,otherPenalty:S,additionalPenalty:k,investment:w,extraProcessing:N,priceRisk:z,crmRisk:B}}},G=e=>{let t=H(e.gf,e.tf,e.price,e.crm),r=X(e.gs,e.t,e.price,e.crm);return{manufacturer:Math.round(t.total),retailer:Math.round(r.total),total:Math.round(t.total+r.total),manufacturerBreakdown:t.breakdown,retailerBreakdown:r.breakdown}},K=e=>{let t={gf:{min:1e3,max:8e3,step:100},tf:{min:20,max:60,step:1},gs:{min:800,max:6e3,step:100},t:{min:15,max:50,step:1},price:{min:60,max:120,step:1},crm:{min:500,max:4e3,step:100}}[e],r=[];for(let i=t.min;i<=t.max;i+=t.step){let t=G({...B,[e]:i});r.push({value:Math.round(100*i)/100,totalCost:t.total,manufacturerCost:t.manufacturer,retailerCost:t.retailer})}return r},Z=e=>{if(e.length<2)return{sensitivity:0,elasticity:0,variance:0};let t=e.map(e=>e.totalCost),r=e.map(e=>e.value),i=(Math.max(...r)-Math.min(...r))/Math.min(...r)*100,l=i>0?(Math.max(...t)-Math.min(...t))/Math.min(...t)*100/i:0,s=t.reduce((e,t)=>e+t,0)/t.length,n=t.reduce((e,t)=>e+Math.pow(t-s,2),0)/t.length,a=e.reduce((e,t)=>t.totalCost<e.totalCost?t:e);return{sensitivity:Math.abs(l),elasticity:l,variance:Math.sqrt(n),minCost:Math.min(...t),maxCost:Math.max(...t),optimalValue:a.value,optimalCost:a.totalCost}},q=async()=>{try{w(!0),setTimeout(()=>{R(a.parameters),M(a.savedModels),w(!1)},1e3)}catch(e){console.error("獲取模型數據失敗:",e),R(a.parameters),M(a.savedModels),w(!1)}},J=()=>{let e={};["gf","tf","gs","t","price","crm"].forEach(t=>{let r=K(t),i=Z(r);e[t]={data:r,metrics:i,label:er(t)}}),L(e)},Q=()=>{let e=G(B),t=_(B.price,B.crm);O({total:e.total,manufacturer:e.manufacturer,retailer:e.retailer,manufacturerBreakdown:e.manufacturerBreakdown,retailerBreakdown:e.retailerBreakdown,demand:t,carbonEfficiencyManufacturer:V(B.gf),carbonEfficiencyRetailer:V(B.gs)})};(0,l.useEffect)(()=>{v||(J(),Q())},[B,v]);let U=["模型設定","成本分析","碳排來源","敏感度","決策地圖","策略比較"],Y=(e,t)=>{R(r=>({...r,[e]:parseFloat(t)}))},ee=(e,t)=>{switch(e){case"gf":case"gs":case"crm":return"$".concat(t.toLocaleString());case"price":return"$".concat(t);case"tf":case"t":return"".concat(t,"天");default:return t}},et=e=>{R({gf:e.gf,tf:e.tf,gs:e.gs,t:e.t,price:e.price,crm:e.crm||1500})},er=e=>({gf:"製造階段投資 (Gf)",tf:"製造商週期 (Tf)",gs:"零售階段投資 (Gs)",t:"零售商週期 (T)",price:"產品定價 (p)",crm:"CRM投資 (m)"})[e]||e,ei=e=>({gf:{min:1e3,max:8e3,step:50},tf:{min:20,max:60,step:1},gs:{min:800,max:6e3,step:50},t:{min:15,max:50,step:1},price:{min:60,max:120,step:1},crm:{min:500,max:4e3,step:50}})[e]||{min:0,max:100,step:1},el=G(B);return v?(0,i.jsx)(s.Z,{children:(0,i.jsx)("div",{className:"loading",children:(0,i.jsx)("div",{className:"spinner"})})}):(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)("div",{className:"page-header",children:[(0,i.jsx)("h1",{className:"page-title",children:"碳排模型決策系統"}),(0,i.jsx)("p",{className:"page-subtitle",children:"基於詳細數學模型的碳排成本分析與最佳化決策支援系統"})]}),(0,i.jsx)("div",{className:"card",style:{marginBottom:"1.5rem"},children:(0,i.jsx)("div",{className:"card-body",style:{padding:"1rem"},children:(0,i.jsx)("div",{style:{display:"flex",gap:"0.5rem",backgroundColor:"#f8fafc",padding:"0.25rem",borderRadius:"0.75rem",overflowX:"auto"},children:U.map((e,t)=>(0,i.jsx)("button",{onClick:()=>z(t),className:"btn ".concat(N===t?"btn-primary":"btn-ghost"),style:{whiteSpace:"nowrap",fontSize:"0.875rem",padding:"0.5rem 1rem"},children:e},e))})})}),0===N&&(0,i.jsxs)("div",{className:"grid grid-cols-3",style:{gap:"1.5rem"},children:[(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"參數設定"}),(0,i.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>F(!0),children:"保存模型"})]}),(0,i.jsxs)("div",{className:"card-body",children:[(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:Object.entries(B).map(e=>{let[t,r]=e;return(0,i.jsx)(d,{label:er(t),value:r,displayValue:ee(t,r),onChange:e=>Y(t,e),min:ei(t).min,max:ei(t).max,step:ei(t).step},t)})}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.75rem",marginTop:"1.5rem"},children:[(0,i.jsx)("button",{onClick:()=>{D(!0),setTimeout(()=>{D(!1),J(),Q()},800)},className:"btn btn-primary",style:{flex:1},disabled:A,children:A?"計算中...":"重新計算"}),(0,i.jsx)("button",{onClick:()=>{R({gf:2800,tf:35,gs:2200,t:25,price:88,crm:1500})},className:"btn btn-secondary",style:{flex:1},children:"重置預設值"})]})]})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"成本構成總覽"}),(0,i.jsx)("span",{className:"status-badge ".concat(I&&G(B).total<18e4?"status-online":"status-maintenance"),children:I&&G(B).total<18e4?"接近最佳點":"可優化空間"})]}),(0,i.jsxs)("div",{className:"card-body",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1",style:{gap:"1rem",marginBottom:"1.5rem"},children:[(0,i.jsx)(c,{label:"總成本",value:el.total,type:"total"}),(0,i.jsx)(c,{label:"製造商成本",value:el.manufacturer,type:"manufacturer"}),(0,i.jsx)(c,{label:"零售商成本",value:el.retailer,type:"retailer"})]}),(0,i.jsxs)("div",{style:{marginTop:"1.5rem"},children:[(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.5rem"},children:"成本構成比例"}),(0,i.jsx)(h,{costs:el})]}),(0,i.jsxs)("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"#f8fafc",borderRadius:"0.5rem"},children:[(0,i.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem"},children:"碳效率指標"}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.75rem",color:"#6b7280"},children:[(0,i.jsxs)("span",{children:["製造商: ",(100*V(B.gf)).toFixed(1),"%"]}),(0,i.jsxs)("span",{children:["零售商: ",(100*V(B.gs)).toFixed(1),"%"]})]})]})]})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card-header",children:(0,i.jsx)("h3",{className:"card-title",children:"智能決策建議"})}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,i.jsx)(m,{title:"成本最佳化建議",content:"當前總成本為 $".concat(el.total.toLocaleString(),"。根據數學模型分析，建議製造階段投資調整至 $3,200-3,800 範圍，製造週期優化至 28-32 天，預期可降低總成本 8-15%。"),type:"primary"}),(0,i.jsx)(m,{title:"碳效率提升建議",content:"當前碳價 $".concat(n.C,"/噸，製造商碳效率 ").concat((100*V(B.gf)).toFixed(1),"%。建議提升製造階段投資至 $4,000 以上，可顯著改善碳效率至 75% 以上。"),type:"info"}),(0,i.jsx)(m,{title:"需求與定價策略",content:"當前需求量 ".concat(_(B.price,B.crm).toLocaleString()," 單位。若提升 CRM 投資至 $").concat((1.2*B.crm).toLocaleString(),"，可在維持價格下增加需求約 12-18%。"),type:"warning"})]})})]})]}),1===N&&E&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"grid grid-cols-2",style:{gap:"1.5rem",marginBottom:"1.5rem"},children:[(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"製造商成本分解"}),(0,i.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["總計: $",E.manufacturer.toLocaleString()]})]}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)(x,{breakdown:E.manufacturerBreakdown})})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"零售商成本分解"}),(0,i.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["總計: $",E.retailer.toLocaleString()]})]}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)(f,{breakdown:E.retailerBreakdown})})]})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"成本構成分析圖表"}),(0,i.jsx)("p",{className:"card-subtitle",children:"各項成本佔比與趨勢分析"})]}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)(g,{costBreakdown:E})})]})]}),2===N&&E&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"grid grid-cols-3",style:{gap:"1.5rem",marginBottom:"1.5rem"},children:[(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card-header",children:(0,i.jsx)("h3",{className:"card-title",children:"碳排放總覽"})}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)(u,{manufacturerBreakdown:E.manufacturerBreakdown,retailerBreakdown:E.retailerBreakdown,carbonPrice:n.C})})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card-header",children:(0,i.jsx)("h3",{className:"card-title",children:"碳效率分析"})}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)(p,{manufacturerEfficiency:E.carbonEfficiencyManufacturer,retailerEfficiency:E.carbonEfficiencyRetailer,manufacturerInvestment:B.gf,retailerInvestment:B.gs})})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card-header",children:(0,i.jsx)("h3",{className:"card-title",children:"減排策略建議"})}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)(b,{parameters:B,costBreakdown:E})})]})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"碳排放來源分布"}),(0,i.jsx)("p",{className:"card-subtitle",children:"製造商與零售商各項碳排放詳細分析"})]}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)(y,{manufacturerBreakdown:E.manufacturerBreakdown,retailerBreakdown:E.retailerBreakdown,carbonPrice:n.C})})]})]}),3===N&&I&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"card",style:{marginBottom:"1.5rem"},children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"敏感度分析"}),(0,i.jsx)("p",{className:"card-subtitle",children:"分析各參數對總成本的影響程度"})]}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:Object.keys(I).map(e=>(0,i.jsx)("button",{onClick:()=>T(e),className:"btn ".concat(P===e?"btn-primary":"btn-secondary"," btn-sm"),children:er(e)},e))})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3",style:{gap:"1.5rem"},children:[(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"敏感度指標"}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:null===(e=I[P])||void 0===e?void 0:e.label})]}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)(j,{metrics:null===(t=I[P])||void 0===t?void 0:t.metrics,currentValue:B[P],formatValue:e=>ee(P,e)})})]}),(0,i.jsxs)("div",{className:"card",style:{gridColumn:"span 2"},children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"敏感度曲線"}),(0,i.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["固定其他變數，分析 ",null===(r=I[P])||void 0===r?void 0:r.label," 對成本的影響"]})]}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)(C,{data:null===(o=I[P])||void 0===o?void 0:o.data,currentValue:B[P],variable:P,formatValue:e=>ee(P,e)})})]})]}),(0,i.jsxs)("div",{className:"card",style:{marginTop:"1.5rem"},children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"全變數敏感度比較"}),(0,i.jsx)("p",{className:"card-subtitle",children:"比較所有變數的敏感度指標，數值越高表示該變數對成本影響越大"})]}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)(S,{sensitivityData:I})})]})]}),N>3&&(0,i.jsx)("div",{className:"card",children:(0,i.jsxs)("div",{className:"card-body",style:{textAlign:"center",padding:"3rem"},children:[(0,i.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\uD83D\uDCCA"}),(0,i.jsx)("h3",{style:{marginBottom:"0.5rem"},children:U[N]}),(0,i.jsx)("p",{style:{color:"#64748b"},children:"此模組正在開發中，敬請期待..."})]})}),W.length>0&&(0,i.jsxs)("div",{className:"card",style:{marginTop:"1.5rem"},children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h3",{className:"card-title",children:"已保存的模型"}),(0,i.jsxs)("span",{className:"text-secondary",children:[W.length," 個模型"]})]}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)("div",{className:"grid grid-cols-4",style:{gap:"1rem"},children:W.map(e=>(0,i.jsx)("div",{className:"card",style:{cursor:"pointer",transition:"all 0.2s ease",border:"1px solid #e5e7eb"},onClick:()=>et(e),children:(0,i.jsxs)("div",{className:"card-body",style:{padding:"1rem"},children:[(0,i.jsx)("h4",{style:{marginBottom:"0.5rem",fontSize:"1rem"},children:e.name}),(0,i.jsxs)("p",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"0.75rem"},children:["總成本: $",e.totalCost.toLocaleString()]}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#94a3b8"},children:["創建於: ",e.createdAt]})]})},e.id))})})]}),$&&(0,i.jsx)(k,{onSave:e=>{let t=G(B),r={id:Date.now(),name:e,...B,totalCost:t.total,createdAt:new Date().toISOString().split("T")[0]};M(e=>[r,...e]),F(!1)},onClose:()=>F(!1)})]})}function d(e){let{label:t,value:r,displayValue:l,onChange:s,min:n,max:a,step:o}=e;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,i.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#374151"},children:t}),(0,i.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#3b82f6",backgroundColor:"#eff6ff",padding:"0.25rem 0.5rem",borderRadius:"0.375rem"},children:l})]}),(0,i.jsx)("input",{type:"range",min:n,max:a,step:o,value:r,onChange:e=>s(e.target.value),style:{width:"100%",height:"0.5rem",borderRadius:"0.25rem",background:"linear-gradient(to right, #3b82f6 0%, #3b82f6 ".concat((r-n)/(a-n)*100,"%, #e5e7eb ").concat((r-n)/(a-n)*100,"%, #e5e7eb 100%)"),outline:"none",appearance:"none"}}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.75rem",color:"#9ca3af",marginTop:"0.25rem"},children:[(0,i.jsx)("span",{children:n}),(0,i.jsx)("span",{children:a})]})]})}function c(e){let{label:t,value:r,type:l="normal"}=e;return(0,i.jsxs)("div",{style:{textAlign:"center",padding:"1rem",backgroundColor:"total"===l?"#f8fafc":"#ffffff",borderRadius:"0.5rem",border:"total"===l?"2px solid #e2e8f0":"1px solid #f3f4f6",overflowX:"auto",whiteSpace:"nowrap",maxWidth:"100%"},children:[(0,i.jsxs)("div",{style:{fontSize:"total"===l?"1.75rem":"1.5rem",fontWeight:"bold",color:(()=>{switch(l){case"total":default:return"#1f2937";case"manufacturer":return"#3b82f6";case"retailer":return"#10b981"}})(),marginBottom:"0.25rem",wordBreak:"break-all",overflowX:"auto"},children:["$",r.toLocaleString()]}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:t})]})}function m(e){let{title:t,content:r,type:l="primary"}=e,s=(()=>{switch(l){case"primary":return{bg:"#f0fdf4",border:"#bbf7d0",title:"#166534",content:"#15803d"};case"info":return{bg:"#eff6ff",border:"#bfdbfe",title:"#1e40af",content:"#2563eb"};case"warning":return{bg:"#fffbeb",border:"#fed7aa",title:"#92400e",content:"#d97706"};default:return{bg:"#f8fafc",border:"#e2e8f0",title:"#374151",content:"#6b7280"}}})();return(0,i.jsxs)("div",{style:{backgroundColor:s.bg,border:"1px solid ".concat(s.border),borderRadius:"0.5rem",padding:"1rem"},children:[(0,i.jsx)("h4",{style:{fontWeight:"500",color:s.title,marginBottom:"0.5rem",fontSize:"0.875rem"},children:t}),(0,i.jsx)("p",{style:{fontSize:"0.8125rem",color:s.content,lineHeight:"1.4",margin:0},children:r})]})}function h(e){let{costs:t}=e,r=t.total,l=(t.manufacturer/r*100).toFixed(1),s=(t.retailer/r*100).toFixed(1);return(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.25rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)("div",{style:{width:"0.75rem",height:"0.75rem",borderRadius:"50%",backgroundColor:"#3b82f6"}}),(0,i.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#374151"},children:"製造商成本"})]}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsxs)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#1f2937"},children:["$",t.manufacturer.toLocaleString()]}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[l,"%"]})]})]}),(0,i.jsx)("div",{style:{width:"100%",backgroundColor:"#e5e7eb",borderRadius:"0.25rem",height:"0.5rem",overflow:"hidden"},children:(0,i.jsx)("div",{style:{height:"0.5rem",borderRadius:"0.25rem",backgroundColor:"#3b82f6",width:"".concat(l,"%"),transition:"width 0.5s ease"}})})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.25rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)("div",{style:{width:"0.75rem",height:"0.75rem",borderRadius:"50%",backgroundColor:"#10b981"}}),(0,i.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#374151"},children:"零售商成本"})]}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsxs)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#1f2937"},children:["$",t.retailer.toLocaleString()]}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[s,"%"]})]})]}),(0,i.jsx)("div",{style:{width:"100%",backgroundColor:"#e5e7eb",borderRadius:"0.25rem",height:"0.5rem",overflow:"hidden"},children:(0,i.jsx)("div",{style:{height:"0.5rem",borderRadius:"0.25rem",backgroundColor:"#10b981",width:"".concat(s,"%"),transition:"width 0.5s ease"}})})]})]})}function x(e){let{breakdown:t}=e,r=[{key:"investment",label:"投資攤提",value:t.investment,color:"#3b82f6"},{key:"startupCarbon",label:"啟動碳成本",value:t.startupCarbon,color:"#ef4444"},{key:"productionCarbon",label:"生產碳排放",value:t.productionCarbon,color:"#f59e0b"},{key:"storageCarbon",label:"儲存碳成本",value:t.storageCarbon,color:"#10b981"},{key:"transportFixedCarbon",label:"運輸固定碳成本",value:t.transportFixedCarbon,color:"#8b5cf6"},{key:"transportVariableCarbon",label:"運輸變動碳成本",value:t.transportVariableCarbon,color:"#06b6d4"},{key:"additionalPenalty",label:"額外碳懲罰",value:t.additionalPenalty,color:"#f97316"}],l=Object.values(t).reduce((e,t)=>e+t,0);return(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.map(e=>{let t=(e.value/l*100).toFixed(1);return(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,i.jsx)("div",{style:{width:"0.5rem",height:"0.5rem",borderRadius:"50%",backgroundColor:e.color,flexShrink:0}}),(0,i.jsxs)("div",{style:{flex:1,fontSize:"0.8125rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("span",{style:{color:"#374151"},children:e.label}),(0,i.jsxs)("span",{style:{fontWeight:"600",color:"#1f2937"},children:["$",Math.round(e.value).toLocaleString()]})]}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[t,"%"]})]})]},e.key)})})}function f(e){let{breakdown:t}=e,r=[{key:"procurement",label:"採購成本",value:t.procurement,color:"#3b82f6"},{key:"crm",label:"CRM投資",value:t.crm,color:"#10b981"},{key:"ordering",label:"訂購成本",value:t.ordering,color:"#f59e0b"},{key:"holdingCarbon",label:"庫存與碳成本",value:t.holdingCarbon,color:"#ef4444"},{key:"transportCarbon",label:"運輸碳成本",value:t.transportCarbon,color:"#8b5cf6"},{key:"otherPenalty",label:"其他碳懲罰",value:t.otherPenalty,color:"#06b6d4"},{key:"additionalPenalty",label:"額外碳懲罰",value:t.additionalPenalty,color:"#f97316"},{key:"investment",label:"投資攤提",value:t.investment,color:"#84cc16"},{key:"extraProcessing",label:"額外處理成本",value:t.extraProcessing,color:"#ec4899"},{key:"priceRisk",label:"價格風險",value:t.priceRisk,color:"#6366f1"},{key:"crmRisk",label:"CRM風險",value:t.crmRisk,color:"#14b8a6"}],l=Object.values(t).reduce((e,t)=>e+t,0);return(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.filter(e=>e.value>0).map(e=>{let t=(e.value/l*100).toFixed(1);return(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,i.jsx)("div",{style:{width:"0.5rem",height:"0.5rem",borderRadius:"50%",backgroundColor:e.color,flexShrink:0}}),(0,i.jsxs)("div",{style:{flex:1,fontSize:"0.8125rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("span",{style:{color:"#374151"},children:e.label}),(0,i.jsxs)("span",{style:{fontWeight:"600",color:"#1f2937"},children:["$",Math.round(e.value).toLocaleString()]})]}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[t,"%"]})]})]},e.key)})})}function g(e){let{costBreakdown:t}=e,r=Object.entries(t.manufacturerBreakdown),l=Object.entries(t.retailerBreakdown);return(0,i.jsxs)("div",{style:{height:"400px",display:"flex",gap:"2rem"},children:[(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h4",{style:{textAlign:"center",marginBottom:"1rem",fontSize:"1rem"},children:"製造商成本構成"}),(0,i.jsxs)("div",{style:{height:"300px",display:"flex",flexDirection:"column",justifyContent:"center",backgroundColor:"#f8fafc",borderRadius:"0.5rem",padding:"1rem"},children:[(0,i.jsxs)("div",{style:{textAlign:"center",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#3b82f6"},children:["$",t.manufacturer.toLocaleString()]}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"總計"})]}),(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.slice(0,5).map((e,r)=>{let[l,s]=e,n=(s/t.manufacturer*100).toFixed(1);return(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",backgroundColor:r%2==0?"#ffffff":"#f1f5f9",borderRadius:"0.25rem"},children:[(0,i.jsx)("span",{style:{fontSize:"0.8125rem"},children:l}),(0,i.jsxs)("span",{style:{fontSize:"0.8125rem",fontWeight:"600"},children:[n,"%"]})]},l)})})]})]}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h4",{style:{textAlign:"center",marginBottom:"1rem",fontSize:"1rem"},children:"零售商成本構成"}),(0,i.jsxs)("div",{style:{height:"300px",display:"flex",flexDirection:"column",justifyContent:"center",backgroundColor:"#f0fdf4",borderRadius:"0.5rem",padding:"1rem"},children:[(0,i.jsxs)("div",{style:{textAlign:"center",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#10b981"},children:["$",t.retailer.toLocaleString()]}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"總計"})]}),(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:l.filter(e=>{let[t,r]=e;return r>0}).slice(0,5).map((e,r)=>{let[l,s]=e,n=(s/t.retailer*100).toFixed(1);return(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",backgroundColor:r%2==0?"#ffffff":"#ecfdf5",borderRadius:"0.25rem"},children:[(0,i.jsx)("span",{style:{fontSize:"0.8125rem"},children:l}),(0,i.jsxs)("span",{style:{fontSize:"0.8125rem",fontWeight:"600"},children:[n,"%"]})]},l)})})]})]})]})}function u(e){let{manufacturerBreakdown:t,retailerBreakdown:r,carbonPrice:l}=e,s=(t.startupCarbon+manufacturerBreakreakdown.productionCarbon+t.storageCarbon+t.transportFixedCarbon+t.transportVariableCarbon+t.additionalPenalty)/l,n=(r.holdingCarbon+r.transportCarbon+r.otherPenalty+r.additionalPenalty+r.extraProcessing)/l*.6;return(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#ef4444",marginBottom:"0.5rem"},children:[(s+n).toFixed(1)," 噸"]}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"總碳排放量"})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.75rem",backgroundColor:"#fef2f2",borderRadius:"0.5rem",border:"1px solid #fecaca"},children:[(0,i.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:"500"},children:"製造商碳排"}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsxs)("div",{style:{fontSize:"0.875rem",fontWeight:"600"},children:[s.toFixed(1)," 噸"]}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#ef4444"},children:["$",(s*l).toLocaleString()]})]})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.75rem",backgroundColor:"#fef7ed",borderRadius:"0.5rem",border:"1px solid #fed7aa"},children:[(0,i.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:"500"},children:"零售商碳排"}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsxs)("div",{style:{fontSize:"0.875rem",fontWeight:"600"},children:[n.toFixed(1)," 噸"]}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#f59e0b"},children:["$",(n*l).toLocaleString()]})]})]})]}),(0,i.jsxs)("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"#f1f5f9",borderRadius:"0.5rem",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#475569",marginBottom:"0.25rem"},children:"當前碳價"}),(0,i.jsxs)("div",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#334155"},children:["$",l,"/噸"]})]})]})}function p(e){let{manufacturerEfficiency:t,retailerEfficiency:r,manufacturerInvestment:l,retailerInvestment:s}=e;return(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.5rem"},children:"製造商碳效率"}),(0,i.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#3b82f6",marginBottom:"0.5rem"},children:[(100*t).toFixed(1),"%"]}),(0,i.jsx)("div",{style:{width:"100%",backgroundColor:"#e5e7eb",borderRadius:"0.25rem",height:"0.5rem",overflow:"hidden"},children:(0,i.jsx)("div",{style:{height:"0.5rem",borderRadius:"0.25rem",backgroundColor:"#3b82f6",width:"".concat(100*t,"%"),transition:"width 0.5s ease"}})}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.25rem"},children:["投資額: $",l.toLocaleString()]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.5rem"},children:"零售商碳效率"}),(0,i.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#10b981",marginBottom:"0.5rem"},children:[(100*r).toFixed(1),"%"]}),(0,i.jsx)("div",{style:{width:"100%",backgroundColor:"#e5e7eb",borderRadius:"0.25rem",height:"0.5rem",overflow:"hidden"},children:(0,i.jsx)("div",{style:{height:"0.5rem",borderRadius:"0.25rem",backgroundColor:"#10b981",width:"".concat(100*r,"%"),transition:"width 0.5s ease"}})}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.25rem"},children:["投資額: $",s.toLocaleString()]})]}),(0,i.jsxs)("div",{style:{padding:"1rem",backgroundColor:"#f0fdf4",borderRadius:"0.5rem",border:"1px solid #bbf7d0"},children:[(0,i.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#166534",marginBottom:"0.5rem"},children:"效率提升建議"}),(0,i.jsxs)("div",{style:{fontSize:"0.8125rem",color:"#15803d",lineHeight:"1.4"},children:[t<.7&&"製造商碳效率偏低，建議增加投資至 $4,000 以上。",r<.6&&"零售商碳效率有改善空間，建議提升投資至 $3,000 以上。",t>=.7&&r>=.6&&"當前碳效率表現良好，可考慮進一步優化營運流程。"]})]})]})}function b(e){let{parameters:t,costBreakdown:r}=e,l=[{title:"製造階段優化",description:"當前製造投資 $".concat(t.gf.toLocaleString(),"，建議提升至 $").concat((1.3*t.gf).toLocaleString()," 以提高碳效率。"),priority:"high",impact:"可減少 15-25% 製造碳排放"},{title:"週期優化",description:"製造週期 ".concat(t.tf," 天，零售週期 ").concat(t.t," 天，建議分別調整至 28-32 天和 20-22 天。"),priority:"medium",impact:"可減少 8-12% 總碳排放"},{title:"供應鏈整合",description:"整合製造與零售階段的碳管理，建立統一的碳追蹤系統。",priority:"medium",impact:"長期可減少 10-18% 碳排放"}],s=e=>{switch(e){case"high":return{bg:"#fef2f2",border:"#fecaca",text:"#dc2626"};case"medium":return{bg:"#fffbeb",border:"#fed7aa",text:"#d97706"};case"low":return{bg:"#f0fdf4",border:"#bbf7d0",text:"#059669"};default:return{bg:"#f8fafc",border:"#e2e8f0",text:"#64748b"}}};return(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:l.map((e,t)=>{let r=s(e.priority);return(0,i.jsxs)("div",{style:{padding:"1rem",backgroundColor:r.bg,border:"1px solid ".concat(r.border),borderRadius:"0.5rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[(0,i.jsx)("h4",{style:{fontSize:"0.875rem",fontWeight:"600",color:r.text},children:e.title}),(0,i.jsx)("span",{style:{fontSize:"0.75rem",padding:"0.125rem 0.375rem",backgroundColor:r.text,color:"white",borderRadius:"0.25rem",textTransform:"uppercase"},children:e.priority})]}),(0,i.jsx)("p",{style:{fontSize:"0.8125rem",color:r.text,marginBottom:"0.5rem",lineHeight:"1.4"},children:e.description}),(0,i.jsxs)("div",{style:{fontSize:"0.75rem",color:r.text,fontWeight:"500"},children:["預期效果: ",e.impact]})]},t)})})}function y(e){let{manufacturerBreakdown:t,retailerBreakdown:r,carbonPrice:l}=e,s=[{name:"生產過程",value:t.productionCarbon/l,color:"#ef4444"},{name:"儲存階段",value:t.storageCarbon/l,color:"#f59e0b"},{name:"運輸過程",value:(t.transportFixedCarbon+t.transportVariableCarbon)/l,color:"#10b981"},{name:"啟動設備",value:t.startupCarbon/l,color:"#3b82f6"},{name:"其他來源",value:t.additionalPenalty/l,color:"#8b5cf6"}],n=[{name:"庫存管理",value:r.holdingCarbon/l*.6,color:"#ef4444"},{name:"運輸配送",value:r.transportCarbon/l,color:"#f59e0b"},{name:"額外處理",value:r.extraProcessing/l,color:"#10b981"},{name:"其他懲罰",value:(r.otherPenalty+r.additionalPenalty)/l*.5,color:"#3b82f6"}],a=s.reduce((e,t)=>e+t.value,0),o=n.reduce((e,t)=>e+t.value,0);return(0,i.jsxs)("div",{style:{height:"400px",display:"flex",gap:"2rem"},children:[(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsxs)("h4",{style:{textAlign:"center",marginBottom:"1rem",fontSize:"1rem"},children:["製造商碳排來源 (",a.toFixed(1)," 噸)"]}),(0,i.jsxs)("div",{style:{height:"300px",position:"relative"},children:[(0,i.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#ef4444"},children:a.toFixed(1)}),(0,i.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"噸 CO₂"})]}),(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginTop:"120px"},children:s.map((e,t)=>{let r=a>0?e.value/a*100:0;return(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)("div",{style:{width:"0.75rem",height:"0.75rem",borderRadius:"50%",backgroundColor:e.color}}),(0,i.jsx)("div",{style:{flex:1,fontSize:"0.8125rem"},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)("span",{children:e.name}),(0,i.jsxs)("span",{style:{fontWeight:"600"},children:[r.toFixed(1),"%"]})]})})]},t)})})]})]}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsxs)("h4",{style:{textAlign:"center",marginBottom:"1rem",fontSize:"1rem"},children:["零售商碳排來源 (",o.toFixed(1)," 噸)"]}),(0,i.jsxs)("div",{style:{height:"300px",position:"relative"},children:[(0,i.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#10b981"},children:o.toFixed(1)}),(0,i.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"噸 CO₂"})]}),(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginTop:"120px"},children:n.map((e,t)=>{let r=o>0?e.value/o*100:0;return(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)("div",{style:{width:"0.75rem",height:"0.75rem",borderRadius:"50%",backgroundColor:e.color}}),(0,i.jsx)("div",{style:{flex:1,fontSize:"0.8125rem"},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)("span",{children:e.name}),(0,i.jsxs)("span",{style:{fontWeight:"600"},children:[r.toFixed(1),"%"]})]})})]},t)})})]})]})]})}function j(e){let{metrics:t,currentValue:r,formatValue:l}=e;return t?(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.5rem"},children:"當前值"}),(0,i.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937",backgroundColor:"#f8fafc",padding:"0.5rem",borderRadius:"0.5rem"},children:l(r)})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1",style:{gap:"0.75rem"},children:[(0,i.jsx)(v,{label:"敏感度係數",value:t.sensitivity.toFixed(3),description:"數值越大表示越敏感"}),(0,i.jsx)(v,{label:"成本變異度",value:"$".concat(Math.round(t.variance).toLocaleString()),description:"成本標準差"}),(0,i.jsx)(v,{label:"最佳值",value:l(t.optimalValue),description:"最低成本對應值"}),(0,i.jsx)(v,{label:"最佳成本",value:"$".concat(Math.round(t.optimalCost).toLocaleString()),description:"最優參數下的成本"})]})]}):null}function v(e){let{label:t,value:r,description:l}=e;return(0,i.jsxs)("div",{style:{padding:"0.75rem",backgroundColor:"#f8fafc",borderRadius:"0.5rem",border:"1px solid #e2e8f0"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.25rem"},children:[(0,i.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#374151"},children:t}),(0,i.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#1f2937"},children:r})]}),(0,i.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:l})]})}function C(e){var t,r,l;let{data:s,currentValue:n,variable:a,formatValue:o}=e;if(!s||0===s.length)return null;let d=Math.max(...s.map(e=>e.totalCost)),c=Math.min(...s.map(e=>e.totalCost)),m=d-c,h=.1*m;return(0,i.jsxs)("div",{style:{height:"350px",position:"relative"},children:[(0,i.jsxs)("div",{style:{position:"absolute",left:0,top:0,bottom:50,width:"80px",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"flex-end",paddingRight:"8px",fontSize:"0.75rem",color:"#6b7280"},children:[(0,i.jsxs)("span",{children:["$",Math.round(d+h).toLocaleString()]}),(0,i.jsxs)("span",{children:["$",Math.round((d+c)/2).toLocaleString()]}),(0,i.jsxs)("span",{children:["$",Math.round(c-h).toLocaleString()]})]}),(0,i.jsx)("div",{style:{marginLeft:"80px",marginBottom:"50px",height:300,position:"relative",backgroundColor:"#f8fafc",borderRadius:"0.5rem",border:"1px solid #e2e8f0"},children:(0,i.jsxs)("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",padding:"16px"},viewBox:"0 0 ".concat(500," ").concat(300),children:[[0,.25,.5,.75,1].map(e=>(0,i.jsx)("line",{x1:"0",x2:500,y1:300*e,y2:300*e,stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"3,3"},e)),[0,.25,.5,.75,1].map(e=>(0,i.jsx)("line",{x1:500*e,x2:500*e,y1:"0",y2:300,stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"3,3"},e)),(0,i.jsx)("polyline",{points:s.map((e,t)=>{let r=t/(s.length-1)*500,i=300-(e.totalCost-c+h)/(m+2*h)*300;return"".concat(r,",").concat(i)}).join(" "),fill:"none",stroke:"#3b82f6",strokeWidth:"3",style:{filter:"drop-shadow(0 2px 4px rgba(59, 130, 246, 0.3))"}}),s.map((e,t)=>{let r=t/(s.length-1)*500,l=300-(e.totalCost-c+h)/(m+2*h)*300,a=e.totalCost===Math.min(...s.map(e=>e.totalCost)),o=.01>Math.abs(e.value-n);return a||o?(0,i.jsxs)("g",{children:[(0,i.jsx)("circle",{cx:r,cy:l,r:o?"8":"6",fill:o?"#ef4444":"#10b981",stroke:"#ffffff",strokeWidth:"2"}),(0,i.jsx)("text",{x:r,y:l-15,textAnchor:"middle",fontSize:"10",fill:o?"#ef4444":"#10b981",fontWeight:"600",children:o?"當前":"最佳"})]},t):null})]})}),(0,i.jsxs)("div",{style:{position:"absolute",bottom:0,left:"80px",right:0,height:"40px",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.75rem",color:"#6b7280"},children:[(0,i.jsx)("span",{children:o(null===(t=s[0])||void 0===t?void 0:t.value)}),(0,i.jsx)("span",{children:o(null===(r=s[Math.floor(s.length/2)])||void 0===r?void 0:r.value)}),(0,i.jsx)("span",{children:o(null===(l=s[s.length-1])||void 0===l?void 0:l.value)})]}),(0,i.jsxs)("div",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(255, 255, 255, 0.95)",padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb",fontSize:"0.75rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,i.jsx)("div",{style:{width:"20px",height:"3px",backgroundColor:"#3b82f6"}}),(0,i.jsx)("span",{children:"總成本曲線"})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,i.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#ef4444"}}),(0,i.jsx)("span",{children:"當前參數值"})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#10b981"}}),(0,i.jsx)("span",{children:"最佳參數值"})]})]})]})}function S(e){let{sensitivityData:t}=e,r=Object.keys(t),l=Math.max(...r.map(e=>t[e].metrics.sensitivity));return(0,i.jsx)("div",{style:{height:"250px",padding:"1rem"},children:(0,i.jsx)("div",{style:{display:"flex",alignItems:"end",gap:"1.5rem",height:"100%"},children:r.map(e=>{let r=t[e].metrics,s=l>0?r.sensitivity/l*100:0;return(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,height:"100%"},children:[(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:"0.75rem"},children:[(0,i.jsx)("span",{style:{fontSize:"1rem",fontWeight:"700",color:"#1f2937",marginBottom:"0.25rem"},children:r.sensitivity.toFixed(3)}),(0,i.jsx)("span",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"敏感度"})]}),(0,i.jsx)("div",{style:{width:"100%",height:"".concat(Math.max(s,5),"%"),backgroundColor:{gf:"#3b82f6",tf:"#10b981",gs:"#f59e0b",t:"#ef4444",price:"#8b5cf6",crm:"#06b6d4"}[e]||"#6b7280",borderRadius:"6px 6px 0 0",transition:"height 0.8s ease-in-out",marginBottom:"0.75rem",minHeight:"20px"}}),(0,i.jsx)("div",{style:{textAlign:"center",fontSize:"0.8125rem",color:"#374151",fontWeight:"500",lineHeight:"1.2"},children:t[e].label.replace(/\s*\([^)]*\)/,"")})]},e)})})})}function k(e){let{onSave:t,onClose:r}=e,[s,n]=(0,l.useState)(""),a=()=>{s.trim()&&t(s.trim())};return(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"12px",minWidth:"400px",maxWidth:"90vw"},children:[(0,i.jsx)("h3",{style:{marginBottom:"1rem"},children:"保存模型"}),(0,i.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,i.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem"},children:"模型名稱"}),(0,i.jsx)("input",{type:"text",value:s,onChange:e=>n(e.target.value),placeholder:"請輸入模型名稱",style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"},onKeyPress:e=>{"Enter"===e.key&&s.trim()&&a()}})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.75rem"},children:[(0,i.jsx)("button",{className:"btn btn-secondary",onClick:r,style:{flex:1},children:"取消"}),(0,i.jsx)("button",{className:"btn btn-primary",onClick:a,disabled:!s.trim(),style:{flex:1},children:"保存"})]})]})})}}},function(e){e.O(0,[725,888,774,179],function(){return e(e.s=1313)}),_N_E=e.O()}]);